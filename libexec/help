#!/usr/bin/env bash
#
# Summary: Prints information about commands
#
# Usage: luaver help [<command>]
#

if [[ $# -ge 1 ]]
then
	command=$1
	shift

	if [[ ! -f libexec/$command ]]
	then
		echo "Command '$command' doesn't exist" 2>&1
		exit 1
	fi

	sed -ne 's/^# \(Usage: .*\)$/\1/ p ; s/^# \(Hint: .*\)$/\1/ p' "libexec/$command"
else
	echo "Usage: luaver <command> [<args>]"
	echo "       luaver help <command>"
	echo "       luaver help"
	echo ""
	echo "Available commands:"

	maxcmdlength=$(find libexec -maxdepth 1 -type f -regex 'libexec/[a-z-]*' | xargs -n1 basename | wc -L)

	for cmdfile in $(find libexec -maxdepth 1 -type f -regex 'libexec/[a-z-]*' | sort)
	do
		printf "  %${maxcmdlength}s  %s\n" "$(basename "$cmdfile")" "$(sed -ne 's/^# Summary: // p' "$cmdfile")"
	done
fi
